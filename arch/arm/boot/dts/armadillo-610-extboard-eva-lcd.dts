/*
 * Copyright (C) 2020 Atmark Techno, Inc. All Rights Reserved.
 *
 * SPDX-License-Identifier: (GPL-2.0 OR MIT)
 */

#define ARMADILLO610_UNUSE_ONBOARD_USDHC2
#include "armadillo-610.dtsi"
#include "armadillo-610-extboard-eva-common.dtsi"
#include <dt-bindings/pwm/pwm.h>

/ {
	ext_backlight_display: ext-backlight-display {
		compatible = "pwm-backlight";
		pwms = <&pwm5 0 5000000 PWM_POLARITY_INVERTED>;
		brightness-levels = <0 4 8 16 32 64 128 255>;
		default-brightness-level = <7>;
		status = "okay";
	};

	extreg_3v3: ext-regulator-3v3 {
		compatible = "regulator-fixed";
		regulator-name = "3V3";
		regulator-min-microvolt = <3300000>;
		regulator-max-microvolt = <3300000>;
		regulator-always-on;
	};

	ext-sound {
		compatible = "simple-audio-card";
		simple-audio-card,name = "mx6ul-wm8978";
		simple-audio-card,format = "i2s";
		simple-audio-card,bitclock-master = <&dailink_master>;
		simple-audio-card,frame-master = <&dailink_master>;

		dailink_master: simple-audio-card,cpu {
			sound-dai = <&sai1>;
		};

		simple-audio-card,codec {
			sound-dai = <&wm8978>;
			clocks = <&clks IMX6UL_CLK_SAI1>;
		};
	};

	ext-gpio-keys {
		compatible = "gpio-keys";
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_ext_gpio_keys>;

		ext_sw1 {
			label = "EXT_SW1";
			gpios = <&gpio4 18 GPIO_ACTIVE_LOW>;
			linux,code = <KEY_BACK>;
		};
		ext_sw2 {
			label = "EXT_SW2";
			gpios = <&gpio4 21 GPIO_ACTIVE_LOW>;
			linux,code = <KEY_MENU>;
		};
		ext_sw3 {
			label = "EXT_SW3";
			gpios = <&gpio4 24 GPIO_ACTIVE_LOW>;
			linux,code = <KEY_HOME>;
		};
	};
};

&iomuxc {
	pinctrl_pwm5: pwm5grp {
		fsl,pins = <
			MX6UL_PAD_NAND_DQS__PWM5_OUT 0x110b0
		>;
	};

	pinctrl_lcdif: lcdifgrp {
		fsl,pins = <
			MX6UL_PAD_LCD_CLK__LCDIF_CLK       0x08
			MX6UL_PAD_LCD_HSYNC__LCDIF_HSYNC   0x08
			MX6UL_PAD_LCD_VSYNC__LCDIF_VSYNC   0x08
			MX6UL_PAD_LCD_ENABLE__LCDIF_ENABLE 0x08

			MX6UL_PAD_LCD_DATA00__LCDIF_DATA00 0x08
			MX6UL_PAD_LCD_DATA01__LCDIF_DATA01 0x08
			MX6UL_PAD_LCD_DATA02__LCDIF_DATA02 0x08
			MX6UL_PAD_LCD_DATA03__LCDIF_DATA03 0x08
			MX6UL_PAD_LCD_DATA04__LCDIF_DATA04 0x08
			MX6UL_PAD_LCD_DATA05__LCDIF_DATA05 0x08
			MX6UL_PAD_LCD_DATA06__LCDIF_DATA06 0x08
			MX6UL_PAD_LCD_DATA07__LCDIF_DATA07 0x08
			MX6UL_PAD_LCD_DATA08__LCDIF_DATA08 0x08
			MX6UL_PAD_LCD_DATA09__LCDIF_DATA09 0x08
			MX6UL_PAD_LCD_DATA10__LCDIF_DATA10 0x08
			MX6UL_PAD_LCD_DATA11__LCDIF_DATA11 0x08
			MX6UL_PAD_LCD_DATA12__LCDIF_DATA12 0x08
			MX6UL_PAD_LCD_DATA13__LCDIF_DATA13 0x08
			MX6UL_PAD_LCD_DATA14__LCDIF_DATA14 0x08
			MX6UL_PAD_LCD_DATA15__LCDIF_DATA15 0x08
			MX6UL_PAD_LCD_DATA16__LCDIF_DATA16 0x08
			MX6UL_PAD_LCD_DATA17__LCDIF_DATA17 0x08
		>;
	};

	pinctrl_sai1: sai1grp {
		fsl,pins = <
			MX6UL_PAD_CSI_DATA01__SAI1_MCLK    0x17088
			MX6UL_PAD_CSI_DATA04__SAI1_TX_SYNC 0x17088
			MX6UL_PAD_CSI_DATA05__SAI1_TX_BCLK 0x17088
			MX6UL_PAD_CSI_DATA06__SAI1_RX_DATA 0x17088
			MX6UL_PAD_CSI_DATA07__SAI1_TX_DATA 0x120b0
		>;
	};

	pinctrl_ext_gpio_keys: extgpiokeysgrp {
		fsl,pins = <
			MX6UL_PAD_CSI_PIXCLK__GPIO4_IO18 0x1b080
			MX6UL_PAD_CSI_DATA00__GPIO4_IO21 0x1b080
			MX6UL_PAD_CSI_DATA03__GPIO4_IO24 0x1b080
		>;
	};

	pinctrl_rtc_s35390a: rtc-s35390agrp {
		fsl,pins = <
			MX6UL_PAD_CSI_DATA02__GPIO4_IO23 0x08000
		>;
	};

	pinctrl_tsc: tscgrp {
		fsl,pins = <
			MX6UL_PAD_GPIO1_IO01__GPIO1_IO01 0xb0
			MX6UL_PAD_GPIO1_IO02__GPIO1_IO02 0xb0
			MX6UL_PAD_GPIO1_IO03__GPIO1_IO03 0xb0
			MX6UL_PAD_GPIO1_IO04__GPIO1_IO04 0xb0
		>;
	};
};

&i2c2 {
	wm8978: wm8978@1a {
		#sound-dai-cells = <0>;
		compatible = "wlf,wm8978";
		reg = <0x1a>;
	};

	s35390a: s35390a@30 {
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_rtc_s35390a>;
		compatible = "sii,s35390a";
		reg = <0x30>;
	};
};

&pwm5 {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_pwm5>;
	#pwm-cells = <3>;
	status = "okay";
};

&tsc {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_tsc>;
	xnur-gpio = <&gpio1 3 GPIO_ACTIVE_LOW>;
	status = "okay";
};

&lcdif {
	pinctrl-names = "default";
	pinctrl-0 = <&pinctrl_lcdif>;
	display = <&display0>;
	lcd-supply = <&extreg_3v3>;
	status = "okay";
	display0: display0 {
		bits-per-pixel = <32>;
		bus-width = <18>;
		display-timings {
			timing0: timing {
				clock-frequency = <9000000>;
				hactive = <480>;
				vactive = <272>;
				hfront-porch = <5>;
				hback-porch = <35>;
				hsync-len = <5>;
				vback-porch = <6>;
				vfront-porch = <8>;
				vsync-len = <2>;
				hsync-active = <0>;
				vsync-active = <0>;
				de-active = <1>;
				pixelclk-active = <0>;
			};
		};
	};
};
